{"version":3,"sources":["js/component/FactorioLogin.js"],"names":["FactorioLogin","Component","constructor","props","state","config","factorioUsername","factorioPassword","factorioSavePw","componentDidMount","$","tooltip","componentWillUnmount","changeUsername","e","setState","target","value","changePassword","changeSavePw","checked","onSave","username","savePw","password","loginController","getAuthToken","then","token","factorioAuthToken","factorioAuthTokenValidTill","Date","now","prevPage","page","catch","error","message","errorText","render","bind"],"mappings":"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","file":"FactorioLogin.js","sourcesContent":["import React from \"react\";\nimport {inject, observer} from 'mobx-react'\nimport FactorioLoginController from '../controller/FactorioLoginController';\n\n@inject('config') @inject('state') @observer\nclass FactorioLogin extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {\n            'username': this.props.config.factorioUsername,\n            'password': this.props.config.factorioPassword,\n            'savePw': this.props.config.factorioSavePw,\n            'errorText': ''\n        }\n    }\n\n    componentDidMount(){\n        $('div.content [data-toggle=\"tooltip\"]').tooltip()\n    }\n    componentWillUnmount(){\n        $('div.content[data-toggle=\"tooltip\"]').tooltip('dispose')\n    }\n\n    changeUsername(e){\n        this.setState({'username': e.target.value});\n    }\n\n    changePassword(e){\n        this.setState({'password': e.target.value});\n    }\n\n    changeSavePw(e){\n        this.setState({'savePw': e.target.checked})\n    }\n\n    onSave(){\n        this.props.config.factorioUsername = this.state.username;\n        this.props.config.factorioSavePw = this.state.savePw;\n        if(this.state.savePw) {\n            this.props.config.factorioPassword = this.state.password;\n        }else{\n            this.props.config.factorioPassword = '';\n            this.props.state.factorioPassword = this.state.password;\n        }\n        let loginController = new FactorioLoginController();\n        loginController.getAuthToken(this.state.username, this.state.password).then((token)=> {\n            this.props.config.factorioAuthToken = token;\n            this.props.config.factorioAuthTokenValidTill = Date.now()+3600;\n            let prevPage = this.props.state.prevPage;\n            this.props.state.prevPage = '';\n            this.props.state.page = prevPage;\n        }).catch((error)=>{\n            if(error.message === 'Unauthorized'){\n                this.setState({\n                    errorText: 'Username and password don\\'t match.'\n                })\n            }else{\n                this.setState({\n                    errorText: 'Something went wrong, please check your internet connection.'\n                })\n            }\n        })\n    }\n\n    render(){\n        return <div>\n            <div className=\"row\">\n                <div className=\"col-6 m-auto\">\n                    <h4 className=\"text-center\">To download Mods and update Factorio to the latest version\n                        YAFMM needs your Login Data for Factorio</h4>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col-6 m-auto\">\n                    <p className=\"text-danger text-center\">{this.state.errorText}</p>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col-6 m-auto\">\n                    <div className=\"form-group\">\n                        <label>Username</label>\n                        <input className=\"form-control\" type=\"text\" value={this.state.username} onChange={this.changeUsername.bind(this)} placeholder=\"Username\" />\n                    </div>\n                    <div className=\"form-group\">\n                        <label>Password</label>\n                        <input className=\"form-control\" type=\"password\" value={this.state.password} onChange={this.changePassword.bind(this)} placeholder=\"Password\" />\n                    </div>\n                    <div className=\"form-check\">\n                        <label className=\"custom-checkbox custom-control\">\n                            <input type=\"checkbox\" className=\"custom-control-input\" onChange={this.changeSavePw.bind(this)}\n                                   checked={this.state.savePw} />\n                            <span className=\"custom-control-indicator\" />\n                            <span className=\"custom-control-description\">Save Password\n                                <i className=\"fa fa-lg fa-fw fa-question-circle-o\" data-toggle=\"tooltip\" data-placement=\"right\"\n                                   title=\"Your Password will only be stored locally\"/></span>\n                        </label>\n                    </div>\n                    <div className=\"form-group\">\n                        <button className=\"btn btn-outline-primary\" onClick={this.onSave.bind(this)} >Save</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    }\n}\n\nexport default FactorioLogin;"]}